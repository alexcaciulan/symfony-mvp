{% extends 'base.html.twig' %}

{% block title %}Schimbă status — Dosar #{{ case.id }}{% endblock %}

{% block body %}
<div style="max-width: 600px; margin: 40px auto; padding: 0 16px;">
    <div style="margin-bottom: 20px;">
        <a href="{{ path('admin') }}" style="color: #2563eb; text-decoration: none; font-size: 14px;">← Înapoi la admin</a>
    </div>

    <h2 style="font-size: 20px; font-weight: 600; color: #111827; margin: 0 0 20px 0;">Schimbă status — Dosar #{{ case.id }}</h2>

    <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 24px; margin-bottom: 20px;">
        <h3 style="margin: 0 0 12px 0; font-size: 16px; color: #374151;">Informații dosar</h3>
        <table style="width: 100%; font-size: 14px;">
            <tr>
                <td style="padding: 4px 8px; color: #6b7280; width: 140px;">Nr. dosar:</td>
                <td style="padding: 4px 8px; font-weight: 600;">#{{ case.id }}</td>
            </tr>
            <tr>
                <td style="padding: 4px 8px; color: #6b7280;">Reclamant:</td>
                <td style="padding: 4px 8px;">{{ case.claimantName ?? '—' }}</td>
            </tr>
            <tr>
                <td style="padding: 4px 8px; color: #6b7280;">Sumă:</td>
                <td style="padding: 4px 8px;">{{ case.claimAmount ? (case.claimAmount|number_format(2, ',', '.') ~ ' RON') : '—' }}</td>
            </tr>
            <tr>
                <td style="padding: 4px 8px; color: #6b7280;">Status curent:</td>
                <td style="padding: 4px 8px;">
                    <span style="display: inline-block; padding: 2px 10px; border-radius: 12px; font-size: 12px; font-weight: 600; background: #e5e7eb; color: #374151;">
                        {{ statusLabels[case.status] ?? case.status }}
                    </span>
                </td>
            </tr>
        </table>
    </div>

    <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 24px;">
        <h3 style="margin: 0 0 16px 0; font-size: 16px; color: #374151;">Aplică tranziție</h3>

        <form method="post" action="{{ path('admin_case_change_status', {id: case.id}) }}">
            <input type="hidden" name="_token" value="{{ csrf_token('change-status-' ~ case.id) }}">

            <div style="margin-bottom: 16px;">
                <label for="transition" style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 6px;">Tranziție</label>
                <select name="transition" id="transition" required style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;">
                    {% for value, label in transitions %}
                        <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>

            <div style="margin-bottom: 20px;">
                <label for="reason" style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 6px;">Motiv (opțional)</label>
                <textarea name="reason" id="reason" rows="3" style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; resize: vertical;" placeholder="Motivul schimbării statusului..."></textarea>
            </div>

            <div style="display: flex; gap: 10px;">
                <button type="submit" style="padding: 8px 20px; background: #2563eb; color: #fff; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer;">
                    Aplică tranziție
                </button>
                <a href="{{ path('admin') }}" style="padding: 8px 20px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; font-weight: 500; text-decoration: none;">
                    Anulează
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
